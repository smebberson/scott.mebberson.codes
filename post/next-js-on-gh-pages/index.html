<!DOCTYPE html><html><head><meta charSet="utf-8" class="next-head"/><link href="https://fonts.googleapis.com/css?family=Bungee|Bungee+Shade|Libre+Barcode+128|Open+Sans:300,400,700" rel="stylesheet" class="jsx-1167118656 next-head"/><script src="https://embed.runkit.com" class="jsx-1167118656 next-head"></script><link rel="preload" href="/_next/static/LvY5Z1nEPQK5__ibAm6kN/pages/post/next-js-on-gh-pages.js" as="script"/><link rel="preload" href="/_next/static/LvY5Z1nEPQK5__ibAm6kN/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-3150b824609f043bd077.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.58de0e6a15b330694496.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-9cfd74346eeb4371ae44.js" as="script"/><style id="__jsx-2011485720">ul.jsx-2011485720{margin:30px 0px;padding:0px;}li.jsx-2011485720{display:inline;font-weight:200;list-style-type:none;margin:0px 5px;text-transform:uppercase;}a.jsx-2011485720{border:1px solid #DFDFDF;border-radius:20px;color:#333;font-size:0.9rem;-webkit-letter-spacing:2px;-moz-letter-spacing:2px;-ms-letter-spacing:2px;letter-spacing:2px;padding:10px 15px;-webkit-text-decoration:none;text-decoration:none;}</style><style id="__jsx-2543978347">header.jsx-2543978347{margin-top:3em;margin-bottom:4em;}h1.jsx-2543978347{text-transform:uppercase;font-weight:600;}</style><style id="__jsx-235007904">header.jsx-235007904{background-color:deepPink;}</style><style id="__jsx-3740271250">header.jsx-3740271250{margin-bottom:3em;padding:6em 0px 3em 0px;position:relative;}time.jsx-3740271250{font-size:0.8em;font-weight:600;position:absolute;top:4.2em;}h1.jsx-3740271250{font-family:'Bungee Shade',sans-serif;font-size:5em;margin:0px;text-align:left;}p.jsx-3740271250{font-family:'Libre Barcode 128',sans-serif;font-size:2em;line-height:0px;margin:0px;}span.jsx-3740271250{display:block;margin-top:0.5em;}</style><style id="__jsx-609079116">code.jsx-609079116{color:deepPink;font-family:Menlo,Monaco,monospace,serif;font-size:0.9em;}code.jsx-609079116::before{content:'`';}code.jsx-609079116::after{content:'`';}</style><style id="__jsx-217828644">.bonus.jsx-217828644{background-color:#fafafa;padding:0.5em;}.bonus.jsx-217828644:last-child{margin-bottom:0px;}h1.jsx-217828644{margin:0.6em 2em 0.4em 1.2em;font-weight:100;font-size:1.2em;}p.jsx-217828644{font-size:0.9em;margin:0.6em 2em 0.8em 2em;}</style><style id="__jsx-568704045">h1.jsx-1167118656{font-weight:600;text-transform:uppercase;-webkit-letter-spacing:2px;-moz-letter-spacing:2px;-ms-letter-spacing:2px;letter-spacing:2px;}div.jsx-1167118656{margin-bottom:5em;}</style><style id="__jsx-1174730564">body{font-family:'Open sans',sans-serif;font-size:16px;font-weight:300;margin:0;padding:0;}.constrained{margin:0 auto;width:80%;max-width:720px;}.align-center{text-align:center;}.code .icon{position:absolute;left:-25px;top:5px;}.code.with-runkit .icon{left:-40px;}.code .icon.good{color:#89c472;}.code .icon.bad{color:#fc6c85;}</style></head><body><div id="__next"><div class="jsx-1167118656 "><header class="jsx-2543978347 constrained align-center"><h1 class="jsx-2543978347">scott.mebberson.codes</h1><nav class="jsx-2011485720"><ul class="jsx-2011485720"><li class="jsx-2011485720"><a class="jsx-2011485720" href="/">Home</a></li><li class="jsx-2011485720"><a class="jsx-2011485720" href="/posts/">Posts</a></li><li class="jsx-2011485720"><a class="jsx-2011485720" href="/cheat-sheets/">Cheat Sheets</a></li><li class="jsx-2011485720"><a class="jsx-2011485720" href="/patterns/">Patterns</a></li><li class="jsx-2011485720"><a class="jsx-2011485720" href="/about/">About</a></li></ul></nav></header><header class="jsx-3740271250 jsx-235007904"><div class="jsx-3740271250 jsx-235007904 constrained"><time class="jsx-3740271250 jsx-235007904">2019-03-25</time><p class="jsx-3740271250 jsx-235007904">Next.js<br/>on<br/>gh-pages<br/></p><h1 class="jsx-3740271250 jsx-235007904">Next.js<br/>on<br/>gh-pages<br/></h1></div></header><div class="constrained"><p>So, you&#x27;ve built an amazing Next.js site. But where do you host it?</p><p>For free, on GitHub Pages of course üòÄ</p><p>There&#x27;s always a caveat... this only works if you can statically export your site.<!-- --> <a href="https://nextjs.org/docs/#static-html-export" target="_blank">Read more about it on next.js</a>. If you can, then you&#x27;re good to go.</p><p><a href="https://nextjs.org/docs/#usage" target="_blank">Follow the steps</a> <!-- -->to create <code class="jsx-609079116 ">exportPathMap</code> in<!-- --> <code class="jsx-609079116 ">next.config.js</code> add <code class="jsx-609079116 ">next build</code> <!-- -->and <code class="jsx-609079116 ">next export</code> scripts to<!-- --> <code class="jsx-609079116 ">package.json</code>.</p><p>All done? You should now have an <code class="jsx-609079116 ">./out</code> <!-- -->directory with your entire website in it.</p><div class="jsx-217828644 bonus"><p class="jsx-217828644">I use the <code class="jsx-609079116 ">serve</code> module to test the<!-- --> <code class="jsx-609079116 ">out</code> directory has everything it needs. Make sure you test loading specific URLs to ensure a direct page load works (versus client side navigation).</p></div><p>Now comes the tricky part... setting up GitHub Pages.</p><p>Here is how it&#x27;s going to work:</p><ul><li>Next.js will produce a static version of the site in the<!-- --> <code class="jsx-609079116 ">out</code> directory.</li><li>We&#x27;ll alias the <code class="jsx-609079116 ">out</code> directory to the<!-- --> <code class="jsx-609079116 ">gh-pages</code> branch.</li><li>We&#x27;ll then push the contents of the<!-- --> <code class="jsx-609079116 ">gh-pages</code> to GitHub to update the site.</li></ul><div class="jsx-217828644 bonus"><p class="jsx-217828644">The following will only work if you&#x27;re intending to use a user or organisation pages site, or a project pages site with a custom domain. If you intend on using a project pages site with the standard GitHub domain (i.e.<!-- --> <code class="jsx-609079116 ">https://\<!-- -->{<!-- -->username<!-- -->}<!-- -->.github.com/<!-- -->{<!-- -->reponame<!-- -->}</code>) then there are a few extra steps to complete.</p></div><p>Okay, let&#x27;s get started by preparing the <code class="jsx-609079116 ">out</code> <!-- -->directory:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray"># Remove files from the out directory</span>
$ <span class="token" style="color:#DD4A68">rm</span> -rf ./out/

<span class="token" style="color:slategray"># Exclude the out directory from Git</span>
$ <span class="token" style="color:#07a">echo</span> <span class="token" style="color:#690">&quot;out/&quot;</span> <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;&gt;</span> .gitignore
$ <span class="token" style="color:#DD4A68">git</span> add <span class="token" style="color:#07a">.</span>
$ <span class="token" style="color:#DD4A68">git</span> commit -m <span class="token" style="color:#690">&quot;Ignore the out directory.&quot;</span>

<span class="token" style="color:slategray"># Create an orphan branch named gh-pages</span>
$ <span class="token" style="color:#DD4A68">git</span> checkout --orphan gh-pages

<span class="token" style="color:slategray"># Remove all staged files</span>
$ <span class="token" style="color:#DD4A68">git</span> <span class="token" style="color:#DD4A68">rm</span> -rf <span class="token" style="color:#07a">.</span>

<span class="token" style="color:slategray"># Create an empty commit (remember this is the gh-page branch)</span>
$ <span class="token" style="color:#DD4A68">git</span> add <span class="token" style="color:#07a">.</span>
$ <span class="token" style="color:#DD4A68">git</span> commit --allow-empty -m <span class="token" style="color:#690">&quot;Initial empty branch&quot;</span>

<span class="token" style="color:slategray"># Push the branch</span>
$ <span class="token" style="color:#DD4A68">git</span> push origin gh-pages
</code></pre><p>Now we can create the Git worktree:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray"># Go back to master</span>
$ <span class="token" style="color:#DD4A68">git</span> checkout master

<span class="token" style="color:slategray"># Create the Git Worktree</span>
$ <span class="token" style="color:#DD4A68">git</span> worktree add out gh-pages
</code></pre><p>Let&#x27;s take a moment here to explore this...</p><p>If you run <code class="jsx-609079116 ">git branch</code> you should be on<!-- --> <code class="jsx-609079116 ">master</code>. Now change into the<!-- --> <code class="jsx-609079116 ">out</code> directory and run<!-- --> <code class="jsx-609079116 ">git branch</code>, you should be on the<!-- --> <code class="jsx-609079116 ">gh-pages</code> branch. So the <code class="jsx-609079116 ">out</code> <!-- -->directory has been directly aliased to the<!-- --> <code class="jsx-609079116 ">gh-pages</code> branch. That&#x27;s kinda neat.</p><p>Let&#x27;s setup the out directory ready for<!-- --> <code class="jsx-609079116 ">gh-pages</code>:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray"># Add a .nojekyll file to out</span>
<span class="token" style="color:#DD4A68">touch</span> ./out/.nojekyll
</code></pre><p>With the hard part out of the way üòÖ, do the following every time you want to deploy a new version of your site:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray"># Build and generate an export</span>
$ yarn build
$ yarn <span class="token" style="color:#DD4A68">export</span>

<span class="token" style="color:slategray"># Push the updated site to GitHub pages</span>
$ <span class="token" style="color:#DD4A68">cd</span> ./out
$ <span class="token" style="color:#DD4A68">git</span> add <span class="token" style="color:#07a">.</span>
$ <span class="token" style="color:#DD4A68">git</span> commit -m <span class="token" style="color:#690">&quot;Deploy to gh-pages üöÄ&quot;</span>
$ <span class="token" style="color:#DD4A68">git</span> push origin gh-pages
</code></pre><p>Now you&#x27;ll need to setup GitHub Pages.<!-- --> <a href="https://help.github.com/en/articles/configuring-a-publishing-source-for-github-pages" target="_blank">GitHub have a guide for configuring a publishing source for GitHub pages</a>, you should be able to follow that. They also have<!-- --> <a href="https://help.github.com/en/articles/quick-start-setting-up-a-custom-domain" target="_blank">a guide for setting up a custom domain</a>.</p><p>...‚òïÔ∏è‚òïÔ∏è... ‚òïÔ∏èÔ∏èÔ∏è?</p><p>And hey presto, your Next.js site should be super zippy üöÄ on the GitHub Pages platform.</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"color":"deepPink","date":"2019-03-25","slug":"next-js-on-gh-pages","teaser":"A simple guide to hosting a Next.js site on GitHub pages.","title":"Next.js on gh-pages"}}},"page":"/post/next-js-on-gh-pages","query":{},"buildId":"LvY5Z1nEPQK5__ibAm6kN","nextExport":true}</script><script async="" id="__NEXT_PAGE__/post/next-js-on-gh-pages" src="/_next/static/LvY5Z1nEPQK5__ibAm6kN/pages/post/next-js-on-gh-pages.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/LvY5Z1nEPQK5__ibAm6kN/pages/_app.js"></script><script src="/_next/static/runtime/webpack-3150b824609f043bd077.js" async=""></script><script src="/_next/static/chunks/commons.58de0e6a15b330694496.js" async=""></script><script src="/_next/static/runtime/main-9cfd74346eeb4371ae44.js" async=""></script></body></html>